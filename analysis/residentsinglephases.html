<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wastech_wire_sizing</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/global.css" rel="stylesheet">
    <link href="../css/blog.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css" />
    <link href="https://fonts.googleapis.com/css?family=Alata&display=swap" rel="stylesheet">
    <script src="../js/jquery-2.1.1.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <style>
        .modal {
            display: none; 
            position: fixed; 
            z-index: 1; 
            padding-top: 190px; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgb(0,0,0); 
            background-color: rgba(0,0,0,0.4); 
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%; 
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        tr>th{
            font-size:12px;
            text-align: center;
        }
        tr>td{
            font-size: 12px;
            text-align: center;
        }
    </style>
  </head>
  
<body>
    <section id="top">
        <div class="container">
            <div class="row">
                <div class="top_1 clearfix">
                    <div class="col-sm-4">
                        <div class="top_1l clearfix">
                            <p class="mgt col"><i class="fa fa-map-marker col_1"></i> Osun State University Osogbo Campus</p>
                            <p class="col"><i class="fa fa-clock-o col_1"></i> Available</p>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="top_1m text-center clearfix">
                            <h1 class="mgt"><a href="index.html">Wastech <span>Wire Sizing Web Application</span></a></h1>
                        </div>
                    </div>
                    <div class="col-sm-4" id="Contact">
                        <div class="top_1r text-center clearfix">
                            <h3 class="mgt"><a href="#"><i class="fa fa-phone col_1"></i> +234 805 577 6749 <span>Call us now. Resistance is futile!</span></a></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="main clearfix">
        <section id="header" class="clearfix">
            <div class="container">
                <div class="row">
                    <div class="haeder clearfix">
                        <nav class="navbar">
                            <div class="navbar-header">
                                <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".js-navbar-collapse">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                                <a class="navbar-brand" href="index.html">Electronica</a>
                            </div>

                            <div class="collapse navbar-collapse js-navbar-collapse">
                                <ul class="nav navbar-nav">
                                    <li><a class="font_tag " href="../index.html">Home</a></li>
                                    <li><a class="font_tag" href="../pages/commercial.html">Commercial</a></li>
                                    <li><a class="font_tag" href="../pages/industry.html">Industrial</a></li>
                                    <li><a class="font_tag active_tab" href="../pages/resident.html">Residential</a></li>
                                    <li><a class="font_tag" href="#Service">Services</a></li>
                                    <li><a class="font_tag" href="#Contact">Contact Us</a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <section id="center" class="center_shop clearfix">
        <div class="container-fluid">
            <div class="row">
                <div class="center_shop_1 text-center clearfix">
                    <div class="col-sm-12">
                        <h2 class="mgt">Single Phase Residential Load Data</h2>
                    </div>
                </div>
                <div class="blog_1 clearfix">
                    <div class="col-sm-9">
                        <div class="blog_1l mgt clearfix" style="overflow: scroll;width:100%">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th scope="col">S/N</th>
                                        <th scope="col">Load</th>
                                        <th scope="col">Rating</th>
                                        <th scope="col">Breaker Size</th>
                                        <th scope="col">Cable Size</th>
                                        <th scope="col">Voltage Drop</th>
                                    </tr>
                                </thead>
                                <tbody id="loadTableBody">
                                    <!-- Dynamic rows will be added here -->
                                </tbody>
                            </table>
                        </div>
                        <button id="performAnalysis" class="btn btn-success" style="margin-top: 10px;">Perform Analysis</button>
                        <button class="btn btn-warning" onclick="window.print()" style="margin-top: 10px;">Print Data</button>
                        <div id="totalPower" style="margin-top: 20px;">
                            <!-- <strong>Total Power (TP): </strong> <span id="totalPowerValue">0</span> kW -->
                        </div>
                        <div id="totalCableSize" style="margin-top: 10px;">
                            <!-- <strong>Recommended Cable Size for Total Power: </strong> <span id="totalCableSizeValue">0mm</span> -->
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <!-- Scrollable modal -->
                        <button id="openModal" class="btn-primary" style="border-radius:10px;padding:10px 15px">Enter Load</button>
                        <button onclick="clearDataAndRefresh()" class="btn-danger" style="border-radius:10px;padding:10px 15px">Clear Data</button>
                        <div id="myModal" class="modal">
                            <div class="modal-content">
                                <span class="close">&times;</span>
                                <p>Select Load Type and Enter Value:</p>
                                <select id="loadType" class="form-control">
                                    <option value="">Select Load Type</option>
                                    <option value="Lightening circuit">Lightening circuit</option>
                                    <option value="Socket 13Amps circuit">Socket 13Amps circuit</option>
                                    <option value="Socket 15Amps circuit">Socket 15Amps circuit</option>
                                    <option value="Water heater">Water heater</option>
                                    <option value="Electric motor (fan)">Electric motor (fan)</option>
                                    <option value="Electric motor (pumping machine)">Electric motor (pumping machine)</option>
                                    <option value="AC Circuit 1">AC Circuit 1</option>
                                    <option value="AC Circuit 2">AC Circuit 2</option>
                                    <option value="Cooker Unit">Cooker Unit</option>
                                </select>
                                <input type="text" id="loadValue" class="form-control" style="margin-top: 10px; display: none;" placeholder="Enter Value">
                                <input type="text" id="lengthValue" class="form-control" style="margin-top: 10px; display: none;" placeholder="Enter Length (meters)">
                                <button id="saveLoad" class="btn btn-primary" style="margin-top: 10px;">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="proj_h">
        <div class="container">
            <div class="row">
                <div class="proj_h1 clearfix">
                    <div class="col-sm-3">
                        <div class="proj_h1i text-center clearfix">
                            <span><i class="fa fa-users"></i></span>
                            <h4>Easy to use</h4>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="proj_h1i text-center clearfix">
                            <span><i class="fa fa-database"></i></span>
                            <h4>Accurate data</h4>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="proj_h1i text-center clearfix">
                            <span><i class="fa fa-cogs"></i></span>
                            <h4>Industry certified</h4>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="proj_h1i text-center clearfix">
                            <span><i class="fa fa-clock-o"></i></span>
                            <h4>Quick calculation</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
		<section id="footer">
			<div class="container">
			 <div class="row">
				
				<div class="footer_3 clearfix">
				<div class="col-sm-7">
				 <div class="footer_3l clearfix">
						<p class="mgt col">© 2024 WASTECH. All Rights Reserved | Design by <a class="col" href="http://awofesobipeace1.netlify.app" target="_blank">CODEMaster</a></p>
				 </div>
				</div>
			 
			 </div>
			 </div>
			</div>
		 </section>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            const modal = document.getElementById("myModal");
            const btn = document.getElementById("openModal");
            const span = document.getElementsByClassName("close")[0];
            const loadType = document.getElementById("loadType");
            const loadValue = document.getElementById("loadValue");
            const lengthValue = document.getElementById("lengthValue");
            const saveLoad = document.getElementById("saveLoad");
            const loadTableBody = document.getElementById("loadTableBody");
            const performAnalysis = document.getElementById("performAnalysis");
            const totalPowerValue = document.getElementById("totalPowerValue");
            const totalCableSizeValue = document.getElementById("totalCableSizeValue");
            const voltage = 230;
            const powerFactor = 0.9;
            const resistivity = 1.68; // Copper resistivity in ohms per meter per mm²

            btn.onclick = function() {
                modal.style.display = "block";
            }

            span.onclick = function() {
                modal.style.display = "none";
            }

            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }

            loadType.onchange = function() {
                if (loadType.value) {
                    loadValue.style.display = "block";
                    lengthValue.style.display = "block";
                } else {
                    loadValue.style.display = "none";
                    lengthValue.style.display = "none";
                }
            }

            saveLoad.onclick = function() {
                const type = loadType.value;
                const value = parseFloat(loadValue.value);
                const length = parseFloat(lengthValue.value);

                if (type && value && length) {
                    let loads = JSON.parse(localStorage.getItem('loads')) || [];
                    loads.push({ type, value, length });
                    localStorage.setItem('loads', JSON.stringify(loads));

                    updateTable();
                    modal.style.display = "none";
                } else {
                    alert("Please select a load type, enter a value, and specify the cable length.");
                }
            }

            function updateTable() {
                const loads = JSON.parse(localStorage.getItem('loads')) || [];
                loadTableBody.innerHTML = "";

                loads.forEach((load, index) => {
                    const row = `<tr>
                            <th scope="row">${index + 1}</th>
                            <td>${load.type}</td>
                            <td>${load.value}W</td>
                            <td></td>
                            <td></td>
                            <td></td>
                    </tr>`;
                    loadTableBody.innerHTML += row;
                });
            }

            performAnalysis.onclick = function() {
                const loads = JSON.parse(localStorage.getItem('loads')) || [];
                let totalPower = 0;

                loads.forEach((load, index) => {
                    let current = load.value / (voltage * powerFactor);

                    if (load.type.includes("AC Circuit")) {
                        current *= 1.25; // Adjust current for AC circuits
                    }

                    console.log(`Load ${index + 1}: ${load.type}, Power: ${load.value}W, Current: ${current.toFixed(2)}A`);

                    let breakerSize;
                    if (current <= 5) {
                        breakerSize = 5;
                    } else if (current <= 10) {
                        breakerSize = 10;
                    } else if (current <= 15) {
                        breakerSize = 15;
                    } else if (current <= 20) {
                        breakerSize = 20;
                    } else if (current <= 25) {
                        breakerSize = 25;
                    } else {
                        breakerSize = 32; 
                    }

                    const cableSize = breakerSize / (1.03 * 0.7);
                    let cableSizeMM;
                    if (cableSize >= 0 && cableSize <= 11) {
                        cableSizeMM = "1mm";
                    } else if (cableSize > 11 && cableSize <= 15) {
                        cableSizeMM = "1.5mm";
                    } else if (cableSize > 15 && cableSize <= 25) {
                        cableSizeMM = "2.5mm";
                    } else if (cableSize > 25) {
                        cableSizeMM = "4mm";
                    }

                    // Voltage drop calculation
                    const voltageDrop = (2 * current * resistivity * load.length) / 1000;
                    
                    const row = document.querySelector(`#loadTableBody tr:nth-child(${index + 1})`);
                    row.cells[3].innerText = breakerSize;
                    row.cells[4].innerText = cableSizeMM;
                    row.cells[5].innerText = voltageDrop.toFixed(2) + "V";

                    // Summing up the power
                    totalPower += load.value;
                });

                // Calculate total current and cable size for total power
                const totalCurrent = totalPower / (voltage * powerFactor);
                let totalCableSize = totalCurrent / (1.03 * 0.7);
                let totalCableSizeMM;

                if (totalCableSize >= 0 && totalCableSize <= 11) {
                    totalCableSizeMM = "1mm";
                } else if (totalCableSize > 11 && totalCableSize <= 15) {
                    totalCableSizeMM = "1.5mm";
                } else if (totalCableSize > 15 && totalCableSize <= 20) {
                    totalCableSizeMM = "2.5mm";
                } else if (totalCableSize > 20 && totalCableSize <= 25) {
                    totalCableSizeMM = "4mm";
                } else if (totalCableSize > 25 ) {
									totalCableSizeMM = "6mm";
							}

                // Update total power and cable size display
                //totalPowerValue.innerText = (totalPower ).toFixed(2) ;
								
                totalPowerValue.innerText = (totalPower / (voltage * powerFactor)).toFixed(2) ;
                totalCableSizeValue.innerText = totalCableSizeMM;
            }

            updateTable();
        });

        function clearDataAndRefresh() {
            localStorage.clear();
            location.reload();
        }
    </script>
  </body>
</html>
